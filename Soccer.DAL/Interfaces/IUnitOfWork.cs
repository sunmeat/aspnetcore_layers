using Soccer.DAL.Entities;

namespace Soccer.DAL.Interfaces
{
    public interface IUnitOfWork // оголошення інтерфейсу unit of work для координації роботи з репозиторіями та збереженням змін
    {
        IRepository<Team> Teams { get; } // властивість для доступу до репозиторію команд
        IRepository<Player> Players { get; } // властивість для доступу до репозиторію гравців
        Task Save(); // асинхронний метод для збереження всіх змін у базі даних (виклик savechangesasync в контексті)
    }
}

/*
 * Інтерфейс IUnitOfWork у цьому коді реалізує шаблон проєктування «Unit of Work»
 * (Одиниця роботи), який призначений для координації роботи кількох репозиторіїв
 * (у даному випадку — репозиторіїв команд і гравців) та управління транзакціями
 * з базою даних в одному контексті. Він надає централізований доступ до репозиторіїв
 * через властивості Teams та Players, дозволяючи виконувати операції з різними
 * сутностями (Team та Player) в межах однієї логічної одиниці роботи,
 * а метод Save() (асинхронний) забезпечує атомарне збереження всіх зроблених змін
 * у базі даних одним викликом SaveChangesAsync() контексту Entity Framework.
 * Це допомагає уникнути розпорошеного коду збереження, спрощує управління транзакціями,
 * підвищує продуктивність та робить код більш чистим і тестопридатним.
 * 
 * https://uk.wikipedia.org/wiki/Unit_Of_Work
 * https://habr.com/ru/articles/784186/
 * https://metanit.com/sharp/mvc5/23.3.php
 * https://habr.com/ru/companies/otus/articles/850124/
 * 
 * Назва патерну Unit of Work (дослівно «Одиниця роботи») походить від ідеї,
 * яку сформулював Мартін Фаулер у своїй книзі Patterns of Enterprise Application Architecture (2002 рік):
 * патерн розглядає бізнес-транзакцію (business transaction) як єдину логічну «одиницю роботи».
 * Це сукупність усіх операцій (додавання, оновлення, видалення об'єктів),
 * які виконуються в межах однієї транзакції та впливають на базу даних.
 * Unit of Work відстежує всі зміни протягом цієї «одиниці», а в кінці координує
 * їхнє одноразове збереження (commit), забезпечуючи атомарність:
 * або всі зміни застосовуються успішно, або жодна (rollback).
 * Така назва підкреслює, що кілька окремих дій об'єднуються в одну неподільну «роботу»,
 * подібно до того, як у базі даних транзакція є одиницею роботи для забезпечення
 * консистентності даних (ACID-властивості). Цей термін став стандартом саме завдяки
 * Фаулеру і досі точно відображає суть патерну.
 */